/*
 * Created on Thu Apr 13 2017 UnsignedInt8
 * Github: https://github.com/unsignedint8
 */

import * as kinq from 'kinq';
import * as assert from 'assert';
import Shares from "../p2pool/p2p/Messages/Shares";

kinq.enable();

describe('BaseShare Test', () => {
    it('should be a share', () => {
        let raw = '0110fd6419fe00000020b11d2466e2b26b8fe380d775a625cbdbaf89b461ca78e400000000000000000042c4ed585a330218b14aa281631bbd3806d0b712386d8aceb03c840933d953950d12dfba83000000000000003103e30a072cfabe6d6d3c6eacc9f783b5bb9ae46a6244b687f4d2bf9c2ba4a914e0f86b4c7d0dab4207080000000000000079bb4ff2194280d64cdc87135b35a900f3f96eea2a12d933e73b2d4d000000004200001094752e6ea6cc5200e711a094e069e419870a52fbe2ae638bcf76b58b18d63ed1937c2aca9af7f2ec160d4f2c9f23bae5d3599923ae8b3d1fbb815199a62b3a7a779f504d85829fe81cefb3ee9859ca0af1892ad4a9a749703bda19cf0116fa0365a7df9089a18ad62bc7b4b3e2ae19ec27c5ccf05c1625bb79164d447e92a27f5cd74d38606dead249b56c47cb020ee3d6607335446f490ec76ce5e9ebfa9883024b9c166e91f5149f6c9a123c3de21b6ad4231b7995f1f8cb2763749a9d674b06cdb219f7a421584aa8b43eb7f6bce7249dfb4fbc360ed394b65e637890e824f550359f8ca87f99b425fef1b18af62cf50da0331f571d42b51092ce3d55f5499a019887c21c583f44fe8c741f877a5b5ab03799f8d9d4c12dfb350e845787ea3493388dc2240206013a6f0a82f53385874f2079cb0e3c8161120b8d8d5e0009943f11da006c33a7169924acc3b3a5e84dbc0bd618fc3b63aa90b4a727afc8ce353fd3fce2748947911de26e84dba7be38b6e3011816c973053910824104d157b559d51dafd10bb75e1e59feaa41333224c21d1f4be4ef9746b2cb738975b28cf7daa1e6a275488891748c13f532f9a921a9dcc9e16832dcbe2657f62fd540302d42fd6b0b957b35a02136385a14873f38ca7a6b8b512aa74a4a66167983bce5c01ef410f863b3893f12de74299f6a39be549cc83280fa90618a3d046b246ae580b9908667339d0f2afde1208ad9f439013821ede93316167cdbf2840be23931d9bc64897cd553afaa9209784f75134908b35f276eceba0f8e79ac9e981b04575aed90ab2a8415b6c16b12ea0e0f0fc4fd43f85a6642e40c8056491bdc9a2f0932b9129fa722482717864e388c7e270f5e4ffd94267c2d7fa2b25bf3fe32d08d9bf7359912192ae9190956617178f2811897d3bf55578c8af0d065769fe74c2b114f81f60003affc8889ed070898aaf59b22d5734f673bbb5578f292587a56fd30b21ef82bea1b0ca2eefb65faeff68768d191ff0d4b242508862ed82080534f39daedc5b1a997e34f8b41d9b33914e69b39dd61b59a9ea17a10cd4369130fcb3d80ceb67aafd9a7137b23231181e61212c8b2d89e937826148ab0e9cc80b15ea4985d2ae4af5028a7a0c2a15f95b6b7e004368b8055ef449fa89fac14c010bee4ee9547df4ade033569ddc45351e2d86c95a43a39176af60f9984c324a686eeef65d525bd70d62fd58150239f3717ef85cf087561b5d3502f817be8231866683551bad04857452e17fc759446668a7d7839ac4763765174009f8137653c9f1015ef4960c48a334663af7fe1df9990e8a6e7d56b937191016852753c28ee730c6d7157279a0cb4f2945110de78c8b1a771453e1dac816d78c5f0b54c9200275709cc768655bd36a2c6ea90a38cd1e181db2fed83abcd8a158fd0857013de50d16a94070c9b57d5e126312c67e44a65010040c64b5c6612db7e1563f44a1959d41bd4b8e9fbd337f7155d25d164ef81c5e727c9949237dfd5740e418523a0e2fe3c556c94485d83fdbc5979baee59bf79abe3c5da0911f5e1b4c343ee3dfd492e16e1d9dac5937f2fedecbe2f301604861515b72aba217eb62056d9a5b0ae8b9651b0b69add6f38873aef63b7c417c070a0787f7a227d75677871068aa8d41d3dfc7238f98be6d8df68b1d28499530ef6ca641cbfacaa92cf8960069e45cc40f426ed3e045571089d261a13deac0de7d7630d82a3e57d815edace37f7cecbe96d3936a9f5b692da860c4c2a54583831db4566497d3125afaa488fa7bbd7e3cd682e489edaaa6b82d60a40fc91861cbbd8f4d8a1a81403f8d1df346c965aa55893f8aaeb88197cefbd7ce07a9b9e70b60bc4f22c705ec1fcc36f371c48c3aa9a9494aaf55312af5d4d0ac13771252e88afc32d53ce302f8df5ff1f92ade82bd35828c6c4065e08fc3437850d70e721915a748e219972bed1d0f062d85acfe2149ae9cd4d8f08d6dff83befaf6bb9459d9c58818804287cfaec12427cf7a0f726d5f0db4dfa784c132b20916163aa5d85d65f16865cdb3ac22cb220400b772ab4fde2dbd30b41b7845fee1b676c70e7984ac63e8f895965039a4441ac98d3d3022ea5e2a3020a85795b6b80c90b8e7141b4eecd6b414144e86192e1e16334b3245dd2e2d9695a3a74426d62ebc18bcce0834cf707c9f073e91502e9081cdcfc51aa96edc843bcb1849f4a00b0d5a7f2258b2ed0c82bd4948dda515120b1885ef729b7eeb054af3c2850c229df5632e7ef558a02cd009ec341241b09f014b48e15af1f52e6f0b9b0a76f15ffec86c68cd9d7b5d9a3503a5af24e549bff689e24c82af94508cfb3b90e953d670a044e5d0424736d229d06b5176e3dc79b6b781e52c2242bce95f23930d53744c69a49ee3760077af8aacb9e8183a454ccf93e3c06608f07c7d7b3393b9e9d3c87962a33be8fc7db25410e08e907f647454cb7262c85df121cd0a54f5865fc5a6fb8890be8d59c497f2a62dc5e4ceb717a8182ea34026b2c49aa506c5bfdb07c30fb22d96ccc5f09dc4f70991dc41ea5997ee0d638d4ea38d9a6043132929544a8c2cc029e44aad9dbecfa3594a2391a43d3b4f90917d9a6a0301aa60ea1b146a55d327940eebf227d47b212f304c3191a0d5e34a6b799bdb2bb72135a528954c1780fc87b41f761b678a4b589e21c0dc952f13d7bcb35c19f6f514d882c3eebd882835574000bb9110d10d4b61ab73d40e7d0d75c76944b17db90482fcd0437b1363b645949e335f89d95ca07444324e4e8be5eeb7a3e6f0e416bed446c71dfbef3c13c565771d7916e2df3ba24bc8e476ed36c9163b8c3537966983746ab973ae67ddbdaa716e51b3c89d11c9c188327f4d5518328e0d1a1cea1b3c265cb2b80e2955f246f70a880480fafc6a52da2fc3eb2ea94ba7a266a388849039ac5c8d4a6b7145bb104ac58e9f8fbf369402d62c756169ca5d6416b6f542ac640c881d619c1f55519cdc089efbee4f2a968e9a36444e6028e0bcee45a484d7d6c166610fff666f2d75ab6771343c2c4ed33c01ed5545bf261150af137bbaa7710a138ce58f872351e796992bc97dc970009379a92ce2fee26ed600805e5981929153fe3de18eb4f23f79631bfa6eb43bdd340a163bbfbf12a55dd564dd93bd1afc6b534c42cb88a01f186a8b01e55fa2e429b65dac53efeda1f5d1917f8e6977f0a9d2c88c8ea3efc8bc26002cdc0b2346c3495fdeb0160121bf19e0e9a1a114afe618f4d05d3e5e84a32e9dd8de27815fcb4ee3b2b41b7647c6be930b760c843e4eea5ee68b6f586d7dcfdbd447c07f46782d011e0d61640ff4fbdf83a1874eec40511b99114caf599d233ba02ad88876c625e5edbf80e8b170a4fff4fb83ed0b4c75a2b6832c679e7c69a5f9661d8612206ab72d7f3e1ee6200d1125be9b5ea96101c7375f60c9c254fa1d54c9946980e8b34c7f1f159aea41eb9a060b0afdf8563439597e3397047daded6d5538c71e65a8bf7b2b8b70c5931ac7e8f49494b1964ac25a3860e7b175b4bf209af90e4565f3fe58925c53c62d806d6620c30972e1fad87f313836410d950e69f5f8ba7abc2a912b71683a57eb7fbb376503cb0cbe8e5d4b7c65e7da2342c6092953bbea1bfa0a7ac6624536a8760f4be2bc9188f26671babf53d4b6d28bf03decb2ec687283b5974dfa599fcd4252d014e740df61c3c434bfa0c8070d1c254513dc35a2989976bde98e9e4b25ef8d05a70c24770031bea5cc3bee331222da849cc56d36b719369b8c8209408412546b77e1f9872945681cffa6beb888faa55633cc235cc726584b81126a598fbb2bde3f1cd4da8bc964457b3c88d39715782e402a0780bde504550120b055b474b3b3322124cea721ac040f6045e5dfe97db01df1ab8b4788f617e7226c7f11f49968194131dff7ed1c75043e918f7abbabedc4f0e3a285b8e5c02ca0357c53dbf0616d0137fc033aab7e496681781356c454ff0d4159a7e0aacdffa5d735a0cf023399cefa98884ddb09e39a81e5ca46a16a0f570189d7de682d20c5cd7c2f67cc57a82cce8ae54f9132c818475d726218e28ddc9c999b71a774f0fe9cb38ddda984a2ccdfa60721e3a877d87948d3841cfc8eab2aa5589a093627305014de0e45b523f74a1e04ebd3129acc6b41fd869bdcf8b615515c309c21c9112c4594e9fd17b325b788c0e24f7a972e64aa725ccb86fda14f2468af2818806159f709b88783565484699c84e1296273fc35d352025377035e645e1d61f24954f361dd09532a31eeee5b4af69e340bea716fc9967727cc85b411e558daa428b054d6d43b50f4ec9dcda1c1444962fd26b76b93a9a387317a6267f1ba75d820dc42584d341b932fdea8f616ebdf90a96e056e8efe51441acfe72b66605ee03bcb270ab281db6184d773b1d186f97b1dd9339f23a187c1029e84a15899f91feeb6ceaa6166e7a9287cf56ca000df573f5b4d5c2e1c3fa6b144d9d5342d1f06c7d799d8b28a609771ca0e24cd6b51294064c220e5305c97b48e3b5e9d2cd557de8a616e59a3890d32a61bd911c054b5ed25dfc07f161ebf28f378be8c7e588dc4806434fb5a23a9a2f682c22ab14ac5eabe6a58bc3a9641e1761f627c85a7db96779094812344c0af5a2ca17c95926fe4a81c3d0149e25516d3c8c5b575ce8b800b28d8785349c9fb53b55c6df561b403f3cd27ae53436fe66fa2355edc6eaf1d89fbe9b08b192c94386089c3426a1799b7aef9f33c64c0a4211c98e37af3664c68e86385fe8b547856440cd1a6a4035db81fb1b52de46a0273ec17a625b2702ea63ab9693af40752a62b10420e410be636643b761ff199435bc9afa614392de3be8d19d51f375f77064319910aef32cccdedac0d0667d413d00831235155fa447040530ae2221985f05727027aead590eb9bdb124f6befdd6259c0ff5f850def50ef51e2377996bd4d7314ac3bf32c5c42d9178e24ab125452032f54666ca53d9faa330580c98ab00ce7107728ebbe30f635f2fa2c0f69a8b74b1f45c7a6503522185d7c901b16caffac77d4a670e75ba02d62e2cb3fec36e1f131432049b1cd412b2d2ffba056b92d740dc2e54bb920cffd09b7c159247bf4dfa3fdab9631d1e5c0b46350a9b7cebdea9f0f573deaa56e9a1722312d58664515f6f518413717078e882b99168bc0bc27dc07d601de747d15bd4aa9f9ed1e1823f1a1b0f7af5acf8026c38b3d941603696081269bf4843ace70e3efa82a77d00474da14e5c347ef6aa3542742ca3a732e99bbd58fad2be27f6d01ef069de677edd3df3c1778a8463329757018edefbc7ff76c413cd272c83bf95fc2de188a75ce2fbd412cc402505c5fbe8e954a6dee75fa3d79ba762cfc1aa973ce137a769d85b70d7ec2e81e74ad0fd3f5e6cd7e65f01a659b1f49c208f29d0e4ebe4fb63fa4c95119faa5cf6d3b3b98622260b4fec0bfd1d6801b4d785d1629e5d051bb239108cf2be8fe9062e446ae9f8a1b965e8200d94ee14b120a24d7efbee8612742c34f0bdb836e3d7caaa7c859487276ec71c1a1115db5d160e95e357e1843542d66c49ccdff17c522cd7d8b1f19b996dd8cdc5efc2b8ed09473ea43a34afb9eb5ab92306d0f24dddf143aa0442646b70985107511776a45d45ec99ad4d7f3ff353785b5b7dcc38c559e6dbe09c2520a8970f614e9485e8ca1c27a81879677f70e4d50dda5a7c93981d8ca157b2fe3659b5e9cc0f9c6bc82e347039048b02952ac2ed4a36aa1b54aa9a3db0e1eee458dca73f0dc2e0909da6301cd5dcee82ce6729e8303af40f34439aa7ee314ce214096e0d5518c3d5eb08ac811acc495dee12a44284512c61d17c1538f2dd26d1b4dea7cd432f5403609bbf95673def38055412db88aee7aec64ea7f7033ebab7e5ddac7e557e6a28a41493a569b0e6328e508adb4b235309b9bcf12d6d9218f76a3cb9ab2a894d35fae1e5e92e0d94a1caecb4ba2f8a10ca81a044572e9e7164cce2200036bf0801d4c28b0076c34299a1630d16332abc930956ca769c3fb68baca48250a3db29641e53a31a739e3e2f07e506a733d526b9cf5d53ccc537999b2321a404378af6c56541884e51d59534a17381fc40bf25ef8526fa70ab15598ac62173eb18569d3f5eb6e036f3183ee2a38c099ec72e9fadd58cab1db1ff7a79dc00c39b247dce706168433bedf0f88f30be78c89c268de936eda5c3a3de65b06b3475759f4a9d8664a7db43f71bffbfe95eef95703355ebd35dd2a08c735c9e876b3a58d80c97f1ef75c834cb8475381b9cf60a8bb7be3f36624dc7640875887a6c0affe8db64916cee368e9da72a0f37a19bdc91e01484ec30f57853a5352d815a00aed89bd8270f8b158ef2f34e550787500859dbd1875112ff2c7815a9ae73e741c3d0859090dc5a3f8fcf837a68d535c6d136f4e542b6868ff92fd16829b3ff2b6e40bc3b0a383a93589e6aed1ea204357ab1f9353646d61adbda0cc48ad19f629457020a82e449278bae094b2c8044a6fceebe4da03f2e07da1de4ad29c72d689559899a3b4ee5a991560747b733ce973d0e62e3963a02d0e1bb3311ba03b6618b7ebcf6c8ff668d9dc0ba2508763ec1896e818b593865fe4b279a9540bd82f1b384170bbb25725008ab5b1d938c12ca25b5ceb30ba77593b5d1fd460204000600050204010000060106020402000104030404000204050603000304060407000400050503040a000606040408030006050409040b0606040c040d040e040f030106070410041104120413041404150200041600070608041704180419041a041b0302041c0008041d0609041e041f04200421060a042204230424042500090426042704280429060b042a060c060d060e042b0201060f0610061109250926000a09270612042c042d042e042f043004310432043303030434043504360437000b043806130439043a0202043b0614000c043c043d043e03040305043f0440000d061506160617030606180441044204430444044502030307000e044606190308061a0309061b061c030a04470448030b04490204044a044b044c061d061e0205044d0504061f044e044f030c06200450063a0451000f045204530454045504560457045805050459045a045b0206045c05060010045d00110012062a045e0013045f046000140461030d046204630464046500150621046606220623001600170624030e046700180625020702080468030f031003110312062603130314001903150316031706270318062806290319031a0a380a39001a031b031c031d031e031f062b0320032103220323001b0209062c020a020b0507020c020d020e020f0210062d062e02110212062f06300631063206330213021402150216021702180219021a021b021c0634021d021e001c021f022006350221063602220223001d022402250226022702280229022a063706380639022b022c022d022e022f023002310232063b023302340235023601000237063c02380239023a023b023c023d023e023f02400241063d001e0242024302440245024602470248063e0249063f024a024b024c024d024e024f02500251025206400641001f0253025402550256025702580101010201030104010501060107064201080109010a010b010c010d0020010e010f00210110011101120113064301140645011506440116011701180119011a0022011b0646011c011d011e0d3b011f0647012001210122012300230124012501260127064801280129012a0d3f0649012b012c012d012e012f064a064b002401300131064c01320133013401350136064d002505080137013800260139013a013b013c013d013e013f064e0140064f0027002801410650014206510143014401450146014701480029002a0652002b002c002d002e002f00300031003206530033003400350036003700380039003a0654003b065506560c03065706580659065a065b065c065d065e065f0660066106620663066406650666066706680669066a066b066c066d066e066f0670003c003d003e003f0040004100420043004400450046004700480049004a004b004c004d004e004f00500051005200530054005500560057067100580059005a005b005c005d06720673005e005f0060006100620063006400650066006700680069006a006b006c006d006e006f0070007100720073007400750076007700780079007a007b007c007d007e007f0080008100820083008400850086008700880089008a008b008c008d008e008f009000910092009351130d90a27c1138a0042b2628c157c458e333097bf89d181c000000000000007e7b041abed6001a50c4ed58c1db3b00a91e0d27875934f7c31e0000000000000002000000c669820007e792c3d95dd148bbdf4bf5350f26b6c2b6c2a9ee7dbc15d0a5371db9f45213fda3140a1b36bda8c50298818c7ca5d2b0074591d85cb6c68d254eef6aab9b0ef092ab29e0b5eddfec9da135470868458b6c4d4a328db132d016d8ebe85210206b1dabdfc531344cecf3f20baeb895e8734ab1279c0147f2a3c08df7f2319e02da06475d69de984fcb74a1ceff59039a107cf894eafbd66fa5e40ce65af6deed35ec2e4370cb991c9a24d756376a334cf8164928cbce0743d09dff80ece697f39b5a1030f8617a135187905f1a38e4e695edc22d7d6c1dbcb7d908ef0002cbd7ea176e50b28a9ab11212b38eb23a177de8d00da19943cc72b6227df0c7124623af48270240d9a0508d2c015b07946257b899f73c7e376ccc078d0669e5077bd7ec0db2077c21c81c31103f5fa8c78486478bc3da74b1547a7a5068ab17040fb0aace86a186c59455c9771d3152a95c917e56264331c9aeb1ad42f2023c3516f0c7119701';

        let shares = Shares.fromBuffer(Buffer.from(raw, 'hex'));
        let share = shares.shares.single().contents;
        assert.equal(share.info.timestamp, 1491977296);
        assert.equal(share.info.newTransactionHashes.includes('178b0ef8db5e5e626c8788ad02ba33d299f5ca1491b91105c4ee74183af8bd4f'), true);
        assert.equal(share.minHeader.previousBlockHash, '000000000000000000e478ca61b489afdbcb25a675d780e38f6bb2e266241db1');
        assert.equal(share.hash, '00000000000000cd04645f76f5bcc20f01c586fb01f6abd06016072ecc468101');
        assert.equal(shares.toBuffer().toString('hex'), raw);
    });
});